# Pytest Showcase Project

This project generated by [Gemini](docs/gemini2.5pro.md) demonstrates various
features of the `pytest` framework and can be used as a template for Python
projects. This is also a demonstration of how powerful assistant an AI engine
can be used safely to improve productivity for general purpose tasks with
clearly defined problems not specific to business sensitive data.

## Structure

```
pytest_showcase/
├── .gitignore          # Standard Python gitignore
├── pyproject.toml      # Modern project metadata, dependencies, build, and pytest config, recommended modern approach
├── pytest.ini          # Alternative pytest configuration (can be omitted if using pyproject.toml)
├── requirements.txt    # List of dependencies (Alternative for dependencies if not using pyproject.toml)
├── README.md           # Project description and instructions
├── src/
│   └── my_package/
│       ├── __init__.py
│       ├── basic_math.py   # Simple functions to test
│       ├── calculator.py   # A class to test
│       ├── data_processor.py # Code needing file I/O and external interaction
│       └── exceptions.py   # Code that raises exceptions
└── tests/
    ├── __init__.py
    ├── conftest.py         # Common fixtures for tests
    ├── test_basic_math.py
    ├── test_calculator.py
    ├── test_data_processor.py
    ├── test_exceptions.py
    └── test_fixtures_and_markers.py
```

-   **`src/my_package/`**: Contains simple Python modules with code to be tested.
-   **`tests/`**: Contains the pytest test files.
-   **`tests/conftest.py`**: Defines shared fixtures.
-   **`pyproject.toml`**: Project configuration, including dependencies and pytest settings (preferred).
-   **`pytest.ini`**: Alternative pytest configuration file.
-   **`requirements.txt`**: Alternative dependency list.

## Setup

1.  **Create a virtual environment:**
    ```bash
    python -m venv .venv
    source .venv/bin/activate  # On Windows use `.venv\Scripts\activate`
    ```

2.  **Install dependencies:**
    (Using `pyproject.toml`)
    ```bash
    pip install -e ".[test]"
    ```
    (Using `requirements.txt`)
    ```bash
    pip install -r requirements.txt
    pip install -e . # Installs src/my_package in editable mode
    ```

## Running Tests

-   **Run all tests:**
    ```bash
    pytest
    ```
    *(Note: The `addopts` in `pyproject.toml`/`pytest.ini` makes this verbose (`-v`) and enables coverage by default).*

-   **Run specific file:**
    ```bash
    pytest tests/test_calculator.py
    ```

-   **Run tests by keyword expression (`-k`):**
    ```bash
    pytest -k "add or total" # Runs tests with 'add' or 'total' in their name
    pytest -k "TestCalculator and not total" # Selects class methods, excludes 'total'
    ```

-   **Run tests by marker (`-m`):**
    ```bash
    pytest -m slow      # Run only tests marked as 'slow'
    pytest -m "not slow" # Run all tests *except* those marked as 'slow'
    pytest -m "api"     # Run only tests marked as 'api'
    ```

-   **Stop on first failure (`-x`):**
    ```bash
    pytest -x
    ```

-   **Show print statements (`-s`):**
    ```bash
    pytest -s
    ```

-   **Generate coverage report only (without running tests again if `.coverage` exists):**
    ```bash
    pytest --cov-report=html
    ```
    *(Open `htmlcov/index.html` in your browser)*

## Features Demonstrated

-   **`tests/test_basic_math.py`**: Basic assertions, `@pytest.mark.parametrize`.
-   **`tests/test_calculator.py`**: Testing class methods, class-scoped fixtures, `pytest.raises`.
-   **`tests/test_exceptions.py`**: Focused examples of `pytest.raises`.
-   **`tests/test_fixtures_and_markers.py`**: Different fixture scopes (`function`, `module`), built-in fixtures (`capsys`), markers (`skip`, `skipif`, `xfail`, custom markers).
-   **`tests/test_data_processor.py`**: Mocking external interactions (`mocker` from `pytest-mock`), using `tmp_path` for file operations.
-   **`tests/conftest.py`**: Defining shared fixtures accessible across test files.